<%configSonos =  JSON.parse(fs.readFileSync('plugins/sonos/configSonosPerso.prop','utf8'));%><html>	<body>		<script>	$(document).ready(function() {		$('#monForm').on('submit', function() {			$.ajax({			  type: "POST",			  url: '/sarah/sonos?actionSonos=saveConfig',			  data: $(this).serialize()			});			return false;		});				$("#plugin-menu .plugin-nav a").click(function () {            $("#plugin-menu .content > ul").hide();            $("#plugin-menu .plugin-nav ul li").removeClass("active");            $(this).parent().addClass("active");            $("#" + $(this).data("toggle")).show();            return false;        });	});		function createEquipements() {		nomEquipement = prompt('Quel est le nom du client Sarah ?');				if (nomEquipement != null) {			$('#tableauEquipements > tbody:last').append('<tr id="ligne_'+nomEquipement+'">														<td>'+nomEquipement+'</td>														<td><input type="text" size="15" maxlength="15" name="equipements['+nomEquipement+'][mac]" value="" /></td>														<td><input type="text" size="15" maxlength="15" name="equipements['+nomEquipement+'][ip]" value="" /></td>														<td><img src="./assets/sonos/images/del.png" alt="Supprimer cet équipement" title="Supprimer cet équipement" style="cursor:pointer" onClick="if (confirm(\'Etes vous sûr de vouloir supprimer cet équipement ?\')) { $(\'#ligne_'+nomEquipement+'\').remove(); }" /></td>													</tr>');		}		return false;	}	</script>	Version : 1.1 - <b>Compatible uniquement sur la version Windows du serveur SARAH</b><br>	Date de publication de la version : 19/02/2014<br>	 <br>	<div id="plugin-menu" class="row-fluid">		<!-- Navigation -->		<div class="span3 well plugin-nav">			<ul class="nav nav-list">				<li class="active"><a href="" data-toggle="plugin-doc">Documentation</a></li>				<li class="active"><a href="" data-toggle="plugin-config">Configuration</a></li>				<li><a href="#" data-toggle="plugin-errors">Erreurs</a></li>			</ul>		</div>		<!-- Content -->		<div class="span9 content">			<ul class="unstyled" id="plugin-doc">				Ce plugin permet de contrôler des périphériques SONOS. Il vous permet aussi de redirigé les TTS à travers votre système SONOS. Il vous faut dans un premier temps récupèrer l'IP et l'adresse MAC de vos équipements SONOS sur le réseau.				 <br/><br/>				Les actions suivantes sont disponibles :<br/>				<ul>					<li>lecture/pause</li>					<li>musique suivante/précédente (next)</li>					<li>augmenter/baisser le volume</li>					<li>synchroniser des pièces</li>				</ul>				<br/><br/>				Dans l'application SONOS sur un PC, allez dans "Aide" puis "A propos de mon système SONOS". Vous y verrez ici l'ensemble des périphériques.<br/>				<img border=0 width=400 height=500 src="./assets/sonos/images/Sonos_IP.png"><br/><br/>				Récupèrer les IP et renseignez les dans la configuration.<br/>				<br/>				Attention à bien faire correspondre le lieu du fichier "sonos.xml" (variable : out.action.idPiece='salon') avec la variable présente dans le fichier de configuration (ip)				<br/><br/>				Vous pouvez commander vos sonos en indiquant à chaque fois l'action et le lieu. Sarah vous répondra dans le lieu en question<br/>				Exemple :<br/>				Sarah --- Action --- lieu<br/>				Sarah --- Allume la musique --- dans le salon<br/>			</ul>			<ul class="unstyled" id="plugin-config" style="display: none;">				<form id="monForm" method="post" action="/sarah/sonos/?actionSonos=saveConfig">					<table class="table table-striped table-hover">						<caption>Paramètre du plugin</caption>						<thead>							<tr>								<td><b>Paramètre</b></td>								<td><b>Valeur</b></td>								<td><b>Commentaire</b></td>							</tr>						</thead>						<tbody>							<tr>								<td>Equipements</td>								<td>								<table id="tableauEquipements" border=1>								<thead>									<tr>										<td align="center">Client</td>										<td align="center">Adresse MAC</td>										<td align="center">Adresse IP</td>										<td></td>									</tr>								</thead>								<tbody>									<% 									for (var key in configSonos.equipements){ %>																				<tr id="ligne_<%= key %>">											<td><%= key %></td>											<td><input type="text" size="15" maxlength="15" name="equipements[<%= key %>][mac]" value="<%= configSonos.equipements[key].mac %>" /></td>											<td><input type="text" size="15" maxlength="15" name="equipements[<%= key %>][ip]" value="<%= configSonos.equipements[key].ip %>" /></td>											<td><img src="./assets/sonos/images/del.png" alt="Supprimer cet équipement" title="Supprimer cet équipement" style="cursor:pointer" onClick="if (confirm('Etes vous sûr de vouloir supprimer cet équipement ?')) { $('#ligne_<%= key %>').remove(); }" /></td>										</tr>										<%									}									%>								</tbody>								</table>								<br />								<a href="#" onClick="return createEquipements();"><img src="./assets/sonos/images/add.png" alt="Ajouter un équipement" style="cursor:pointer" onClick="" /> Ajouter un équipement</a>								</td>								<td>Configuration des équipements SONOS									<br />									Les adresses MAC doivent se saisir sans les ":".									<b>Les noms des équipements doivent être strictement identique au nom du client SARAH. Vous trouverez ce nom dans le fichier custom.ini (client=).</b>								</td>							</tr>							<tr>								<td>Volume des annonces</td>								<td><input type="number" name="volumeAnnonce" min="0" max="100" value="<%= configSonos.volumeAnnonce %>" /></td>								<td>Permet de définir le volume quand Sarah parle.</td>							</tr>							<tr>								<td>Radio</td>								<td><input type="text" name="defaultRadio" value="<%= configSonos.defaultRadio %>" /></td>								<td>Permet de définir la radio par défaut que Sarah peut lancer.									<br />									Google Musique (j'ai de la chance) : x-sonosapi-radio:Ivvo_gGiNo8?sid=151								</td>							</tr>							<tr>								<td>Exporter les voix</td>								<td>									<select name="exportAllVoice">										<option value="1" <% if (configSonos.exportAllVoice == 1){ %>selected<% } %>>Oui</option>										<option value="0" <% if (configSonos.exportAllVoice == 0){ %>selected<% } %>>Non</option>									</select>								</td>								<td>								<ul>									<li> Non : Sarah ne parle qu'à travers vos enceintes habituelles</li>									<li> Oui : Sarah ne parlera qu'à travers le système SONOS, même pour les autres plugins. Ce paramétrage active le multiroom.</li>								</ul>								<b>NOTE: ce paramètre nécessite un redémarage du serveur SARAH (NodeJS)</b>								</td>							</tr>						</tbody>					</table>									<input type="submit" />				</form>			</ul>		</div>	</div>	</body></html>